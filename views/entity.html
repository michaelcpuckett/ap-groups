{% from "header.html" import header with context %}
{% from "about.html" import about with context %}

{% if entity.type === 'Group' %}
  {% if entity.streams %}
    {% for stream in entity.streams %}
      {% if stream === (entity.url + '/shared') %}
      <!doctype html>
        <html>
          <title>@{{ entity.preferredUsername }}@chirp.social</title>
          <meta name="description" content="{{ group.summary }}" />
          <meta name="viewport" content="width=device-width, initial-scale=1" />
          <link rel="stylesheet" href="base.css" />
          <link rel="stylesheet" href="index.css" />
          <body>
            <div class="root">
              <div class="container">
                {{ header() }}
                <section role="region">
                  <h1>
                    {% if entity.name %}
                      {{ entity.name }}
                    {% else %}
                      {{ entity.preferredUsername }}
                    {% endif %}
                  </h1>
                  <div class="avatar-summary">
                    {% if entity.icon %}
                      <img
                        class="avatar"
                        height="100"
                        width="100"
                        src="{{ entity.icon.url }}"
                      />
                    {% endif %}
                    <div>
                      <p>
                        <strong>
                          @{{ entity.preferredUsername }}@chirp.social
                        </strong>
                      </p>
                      {% if entity.summary %}
                        <p>
                          {{ entity.summary }}
                        </p>
                      {% endif %}
                      <p>
                        {{ followersCount }} followers
                      </p>
                    </div>
                  </div>
                  <h2>
                    Posts
                  </h2>
                  {% if shared.length %}
                    <div class="regions">
                      {% for postId in shared %}
                        <div class="region">
                          <announce-entity entity-id="{{ postId }}">
                            <!-- Fallback for legacy accounts -->
                            <post-entity entity-id="{{ postId }}"></post-entity>
                          </announce-entity>
                        </div>
                      {% endfor %}
                    </div>
                  {% else %}
                    <div class="region">
                      <p>No posts yet.</p>
                    </div>
                  {% endif %}
                </section>
                <script type="module" src="group-entity.js"></script>
              </div>
              <div class="right-rail">
                {{ about() }}
              </div>
            </div>
          </body>
        </html>
      {% endif %}
    {% endfor %}
  {% endif %}
{% endif %}