{% from "header.html" import header with context %}
{% from "about.html" import about with context %}

{% if entity.type === 'Collection' or entity.type === 'OrderedCollection' %}
  <textarea>{{ entity | dump }}</textarea>
{% endif %}

{% if entity.type === 'Group' %}
  {% if entity.streams %}
    {% for stream in entity.streams %}
      {% if stream === (entity.url + '/shared') %}
      <!doctype html>
        <html>
          <title>@{{ entity.preferredUsername }}@chirp.social</title>
          <meta name="viewport" content="width=device-width, initial-scale=1" />
          <meta charset="utf-8" />
          <meta name="description" content="{{ group.summary }}" />
          <link rel="stylesheet" href="base.css" />
          <link rel="stylesheet" href="index.css" />
          <body>
            <div class="root">
              <div class="container">
                {{ header() }}
                <section role="region">
                  <h1>
                    {% if entity.name %}
                      {{ entity.name }}
                    {% else %}
                      {{ entity.preferredUsername }}
                    {% endif %}
                  </h1>
                  <div class="avatar-summary">
                    {% if entity.icon %}
                      <img
                        class="avatar"
                        height="100"
                        width="100"
                        src="{{ entity.icon.url }}"
                      />
                    {% endif %}
                    <div>
                      <p>
                        <strong>
                          @{{ entity.preferredUsername }}@chirp.social
                        </strong>
                      </p>
                      {% if entity.summary %}
                      {% endif %}
                        <dl>
                          <dt>
                            Group Summary
                          </dt>
                          <dt>
                            {{ entity.summary }}
                          </dt>
                          {% for attachment in entity.attachment %}
                            <dt>
                              {{ attachment.name }}
                            </dt>
                            <dd>
                              {{ attachment.value }}
                            </dd>
                          {% endfor %}
                          <dt>
                            Followers
                          </dt>
                          <dd>
                            {{ followersCount }}
                          </dd>
                          <dt>
                            <a href={{ stream }}>
                              Posts
                            </a>
                          </dt>
                          <dd>
                            <a href={{ stream }}>
                              {{ shared.length }}
                            </a>
                          </dd>
                        </dl>
                    </div>
                  </div>
                </section>
                <script type="module" src="group-entity.js"></script>
              </div>
              <div class="right-rail">
                <header>
                  <a href="/directory" class="button button--cta">
                    Group Directory
                    <span>See All Groups</span>
                  </a>
                </header>
                {{ about() }}
              </div>
            </div>
          </body>
        </html>
      {% endif %}
    {% endfor %}
  {% endif %}
{% endif %}